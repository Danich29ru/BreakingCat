Вниманье!!!
Код ужасен и безобразен, он писался под действием этанола. 
Код не предназначен для просмотра женщинам с психическими либо психологическими заболеваниями, 
животным моложе 16ти лет и беременным детям. Спасибо за внимание.

Структура проекта крайне проста даже для накуренного младенца:
./source/ - исходный код
./vssln/ - решение для Visual Studio 2013